(this.webpackJsonp=this.webpackJsonp||[]).push([[0],{109:function(e,t,n){"use strict";n.d(t,"a",(function(){return B}));var r=n(0),o=n(11),i=n(10),a=n(23),c=n(108),u=n(3),l=n(144),d=n(68),s=n(69),f=n(2);function h(){return Object(f.jsxs)(u.a,{style:{height:56,flexDirection:"row",justifyContent:"space-between",alignItems:"center"},children:[Object(f.jsx)(u.a,{style:{paddingLeft:20},children:Object(f.jsx)(a.a,{style:{fontWeight:"bold",fontSize:20},children:"React Native Virtualized Grid"})}),Object(f.jsxs)(u.a,{style:{paddingRight:20,flexDirection:"row",alignItems:"center"},children:[Object(f.jsx)(d.a,{style:{marginRight:12},onPress:function(){s.a.openURL("https://twitter.com/770hz")},children:Object(f.jsx)(l.a,{name:"twitter",size:24,color:"#1d9bf0"})}),Object(f.jsx)(d.a,{onPress:function(){s.a.openURL("https://github.com/heineiuo/react-native-virtualized-grid")},children:Object(f.jsx)(l.a,{name:"github",size:24,color:"black"})})]})]})}var b=n(13),m=n.n(b),y=n(59),p=n.n(y),w=n(30);function g(e){var t=e.renderCell,n=e.column,r=e.row;return Object(f.jsx)(o.a.View,{style:{position:"absolute",width:n.widthAnimated,zIndex:o.a.add(n.zIndexAnimated,r.zIndexAnimated),height:r.heightAnimated,transform:[{translateX:n.xAnimated},{translateY:r.yAnimated}]},children:t({column:n,row:r})})}var O=Object(r.createContext)({}),j=function(){return Object(r.useContext)(O)},x=n(15),v=n.n(x),I=n(16),A=n.n(I);var R=function(){function e(){v()(this,e),this._x=0,this._y=0,this.xAnimated=new o.a.Value(0),this.yAnimated=new o.a.Value(0),this.rowIndex=0,this.columnIndex=0,this.left=0,this.top=0}return A()(e,[{key:"x",get:function(){return this._x},set:function(e){this._x=e,this.xAnimated.setValue(e)}},{key:"y",get:function(){return this._y},set:function(e){this._y=e,this.yAnimated.setValue(e)}}]),e}(),C=function(){function e(t){var n=t.x,r=t.width,i=t.columnIndex,a=t.freezed,c=void 0!==a&&a;v()(this,e),this.xAnimated=new o.a.Value(n),this.widthAnimated=new o.a.Value(r),this.columnIndex=i,this.freezed=c,this.zIndexAnimated=new o.a.Value(c?1:0),this.highlightOpacityAnimated=new o.a.Value(0),this.recycled=!1}return A()(e,[{key:"x",get:function(){return JSON.parse(JSON.stringify(this.xAnimated))}},{key:"width",get:function(){return JSON.parse(JSON.stringify(this.widthAnimated))}}]),e}(),P=function(){function e(t){var n=t.y,r=t.height,i=t.rowIndex,a=t.freezed,c=void 0!==a&&a;v()(this,e),this.yAnimated=new o.a.Value(n),this.heightAnimated=new o.a.Value(r),this.rowIndex=i,this.freezed=c,this.zIndexAnimated=new o.a.Value(c?1:0),this.highlightOpacityAnimated=new o.a.Value(0),this.recycled=!1}return A()(e,[{key:"y",get:function(){return JSON.parse(JSON.stringify(this.yAnimated))}},{key:"height",get:function(){return JSON.parse(JSON.stringify(this.heightAnimated))}}]),e}();!function(){function e(t){var n=t.column,o=t.row;v()(this,e),this.column=n,this.row=o,this.ref=Object(r.createRef)()}A()(e,[{key:"x",get:function(){return this.column.x}},{key:"y",get:function(){return this.row.y}},{key:"width",get:function(){return this.column.width}},{key:"height",get:function(){return this.row.height}}])}();function S(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function z(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?S(Object(n),!0).forEach((function(t){m()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):S(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function k(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return V(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return V(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function V(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function E(e){var t,n,a=e.style,c=(e.columnCount,e.rowCount,e.renderCell),l=e.onChangeColumn,d=void 0===l?function(e){}:l,s=e.onChangeRow,h=void 0===s?function(e){}:s,b=e.getColumnWidth,m=void 0===b?function(){return 100}:b,y=e.getRowHeight,j=void 0===y?function(){return 40}:y,x=(e.showColumnLine,e.showRowLine,e.freezedColumns),v=void 0===x?{}:x,I=e.freezedRows,A=void 0===I?{}:I,S=e.onChangeColumnOrder,V=void 0===S?function(){}:S,E=e.onChangeRowOrder,M=void 0===E?function(){}:E,F=(e.onChangeVisibleArea,Object(r.useRef)(null)),D=null!=(t=v.start)?t:0,N=null!=(n=A.start)?n:0,T=Object(r.useRef)([]),J=Object(r.useRef)([]),L=Object(r.useState)({allFreezed:[],notFreezed:[],columnFreezed:[],rowFreezed:[]}),_=p()(L,2),X=_[0],G=X.allFreezed,W=X.notFreezed,H=X.columnFreezed,U=X.rowFreezed,Y=_[1],$=Object(r.useRef)(new R),q=Object(r.useRef)({width:0,height:0}),B=Object(r.useCallback)((function(){var e=q.current,t=e.width,n=e.height,r=$.current,o=r.rowIndex,i=r.columnIndex,a=r.left,u=r.top,l=r.x,d=r.y,s=a,h=u,b=i,y=o,p=[],w=[];if(D>0&&b>D-1)for(var O=0,x=0;O<D;){var v=m({columnIndex:O});w.push(new C({columnIndex:O,width:v,x:x,freezed:!0})),O++,x+=v}for(;;){var I=m({columnIndex:b});if(w.push(new C({columnIndex:b,width:I,x:s,freezed:b<D})),b++,(s+=I)>-l+t)break}if(N>0&&y>N-1)for(var A=0,R=0;A<N;){var S=j({rowIndex:A});p.push(new P({rowIndex:A,height:S,y:R,freezed:!0})),A++,R+=S}for(;;){var z=j({rowIndex:y});if(p.push(new P({rowIndex:y,height:z,y:h,freezed:y<N})),y++,(h+=z)>-d+n)break}T.current=w,J.current=p;for(var V=[],E=[],M=[],F=[],L=0,_=w;L<_.length;L++)for(var X,G=_[L],W=k(p);!(X=W()).done;){var H=X.value,U=Object(f.jsx)(g,{column:G,row:H,renderCell:c},G.columnIndex+"/"+H.rowIndex);G.freezed&&H.freezed?V.push(U):G.freezed?M.push(U):H.freezed?F.push(U):E.push(U)}Y({allFreezed:V,notFreezed:E,columnFreezed:M,rowFreezed:F})}),[m,j,c,D,N]),K=Object(r.useCallback)((function(e){var t=e.nativeEvent.layout,n=t.width,r=t.height;q.current.width=n,q.current.height=r,B()}),[B]),Q=Object(r.useCallback)((function(e){var t=e.deltaX,n=e.deltaY,r=$.current,o=r.columnIndex,i=r.rowIndex,a=r.left,c=r.top,u=$.current.x-t;if(u>0)u=0,$.current.x=0,$.current.columnIndex=0,$.current.left=0;else{$.current.x=u;var l=o,d=a,s=a;if(t>0){for(;;){if(d=s,(s+=m({columnIndex:l}))>=-u)break;l++}$.current.columnIndex=l,$.current.left=d}else{for(;!(d<=-u);){l--,d-=m({columnIndex:l})}$.current.columnIndex=l,$.current.left=d}}var f=$.current.y-n;if(f>0)f=0,$.current.y=0,$.current.top=0,$.current.rowIndex=0;else{$.current.y=f;var h=i,b=c,y=c;if(n>0){for(;;){if(b=y,(y+=j({rowIndex:h}))>=-f)break;h++}$.current.rowIndex=h,$.current.top=b}else{for(;!(b<=-f);){h--,b-=j({rowIndex:h})}$.current.rowIndex=h,$.current.top=b}}B()}),[B,m,j]),Z=Object(r.useCallback)((function(e){var t=e.deltaX,n=e.deltaY;Q({deltaX:t,deltaY:n})}),[Q]);Object(r.useEffect)((function(){if("web"===i.a.OS){var e=F.current;return e.addEventListener("wheel",Z),function(){e.removeEventListener("wheel",Z)}}}),[Z]);var ee=Object(r.useMemo)((function(){var e=null;return w.a.create({onPanResponderGrant:function(t,n){e=z({},n)},onMoveShouldSetPanResponder:function(){return!0},onPanResponderMove:function(t,n){if(e){var r=-n.dx+e.dx,o=-n.dy+e.dy;e=z({},n),Q({deltaX:r,deltaY:o})}else e=z({},n)},onPanResponderRelease:function(){e=null}})}),[Q]);return Object(f.jsx)(O.Provider,{value:{virtualColumns:T,virtualRows:J,onChangeColumn:d,onChangeRow:h,coordinate:$,containerSize:q,updateCoordinate:Q,onChangeColumnOrder:V,onChangeRowOrder:M},children:Object(f.jsx)(u.a,z(z({ref:F,style:[{overflow:"hidden"},a],onLayout:K},ee.panHandlers),{},{children:[{key:"notFreezed",data:W,x:!0,y:!0},{key:"columnFreezed",data:H,y:!0},{key:"rowFreezed",data:U,x:!0},{key:"allFreezed",data:G}].map((function(e){var t=e.key,n=e.data,r=e.x,i=void 0!==r&&r,a=e.y,c=void 0!==a&&a;return Object(f.jsx)(o.a.View,{style:{transform:[{translateX:i?$.current.xAnimated:0},{translateY:c?$.current.yAnimated:0}]},children:n},t)}))}))})}var M=n(62);function F(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function D(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?F(Object(n),!0).forEach((function(t){m()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):F(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function N(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return T(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return T(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function T(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function J(e){var t=e.column,n=e.row,i=j(),a=i.virtualColumns,c=i.onChangeColumn,u=Object(r.useMemo)((function(){var e=[];return w.a.create({onPanResponderTerminate:function(e,t){},onPanResponderTerminationRequest:function(e,t){return!1},onPanResponderReject:function(){},onMoveShouldSetPanResponder:function(e,t){return!0},onPanResponderGrant:function(){t.widthAnimated.setOffset(t.width),e=[];for(var n,r=N(a.current);!(n=r()).done;){var o=n.value;o.columnIndex>t.columnIndex&&(e.push(o),o.xAnimated.setOffset(o.x))}},onPanResponderMove:function(n,r){for(var o,i=N(e);!(o=i()).done;){o.value.xAnimated.setValue(r.dx)}t.widthAnimated.setValue(r.dx),c(t)},onPanResponderRelease:function(){t.widthAnimated.flattenOffset();for(var n,r=N(e);!(n=r()).done;){n.value.xAnimated.flattenOffset()}e=[]}})}),[t,a,c]);return Object(f.jsx)(o.a.View,D(D({},u.panHandlers),{},{style:[{position:"absolute",top:0,right:0,zIndex:10,height:n.height,width:20}],children:Object(f.jsx)(M.a,{style:[{display:"flex",alignItems:"flex-end",height:n.height}],children:function(e){var t=e.hovered;return Object(f.jsx)(o.a.View,{style:[{height:n.heightAnimated,width:0},t&&{width:5,backgroundColor:"blue"}]})}})}))}function L(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function _(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?L(Object(n),!0).forEach((function(t){m()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):L(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function X(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return G(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return G(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function G(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function W(e){var t=e.column,n=e.row,i=e.children,a=j(),c=a.virtualColumns,u=a.onChangeColumnOrder,l=Object(r.useMemo)((function(){var e=0,n=null,r=0;return w.a.create({onPanResponderTerminate:function(e,t){},onPanResponderTerminationRequest:function(e,t){return!1},onPanResponderReject:function(){},onMoveShouldSetPanResponder:function(e,t){return!0},onPanResponderGrant:function(n){e=t.x+n.nativeEvent.locationX,r=t.columnIndex},onPanResponderMove:function(t,r){for(var o,i=X(c.current);!(o=i()).done;){var a=o.value,u=a.x+a.width/2;if(Math.abs(u-e-r.dx)<a.width/2){if(console.log("highlightcolumn",a.columnIndex),n===a)break;n&&n.highlightOpacityAnimated.setValue(0),(n=a).highlightOpacityAnimated.setValue(1);break}}},onPanResponderRelease:function(){n&&(n.highlightOpacityAnimated.setValue(0),r!==n.columnIndex&&u({fromIndex:r,toIndex:n.columnIndex}))}})}),[t,u,c]);return Object(f.jsx)(o.a.View,_(_({},l.panHandlers),{},{style:[{position:"absolute",zIndex:8,top:0,left:0,height:n.height,width:t.width}],children:i}))}function H(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function U(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?H(Object(n),!0).forEach((function(t){m()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):H(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Y(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return $(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return $(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function $(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function q(e){var t=e.column,n=e.row,i=j(),a=i.virtualRows,c=i.onChangeRow,u=Object(r.useMemo)((function(){var e=[];return w.a.create({onPanResponderTerminate:function(e,t){},onPanResponderTerminationRequest:function(e,t){return!1},onPanResponderReject:function(){},onMoveShouldSetPanResponder:function(e,t){return!0},onPanResponderGrant:function(){n.heightAnimated.setOffset(n.height),e=[];for(var t,r=Y(a.current);!(t=r()).done;){var o=t.value;o.rowIndex>n.rowIndex&&(e.push(o),o.yAnimated.setOffset(o.y))}},onPanResponderMove:function(t,r){for(var o,i=Y(e);!(o=i()).done;){o.value.yAnimated.setValue(r.dy)}n.heightAnimated.setValue(r.dy),c(n)},onPanResponderRelease:function(){n.heightAnimated.flattenOffset();for(var t,r=Y(e);!(t=r()).done;){t.value.yAnimated.flattenOffset()}e=[]}})}),[n,a,c]);return Object(f.jsx)(o.a.View,U(U({},u.panHandlers),{},{style:[{position:"absolute",bottom:0,left:0,zIndex:10,height:20,width:t.width}],children:Object(f.jsx)(M.a,{style:[{display:"flex",justifyContent:"flex-end",width:t.width,height:20}],children:function(e){var n=e.hovered;return Object(f.jsx)(o.a.View,{style:[{width:t.widthAnimated,height:0},n&&{height:5,backgroundColor:"blue"}]})}})}))}function B(){var e=Object(c.a)(),t=e.width,n=e.height,l=Object(r.useRef)(new Map),d=Object(r.useRef)(new Map),s=Object(r.useCallback)((function(e){l.current.set(""+e.columnIndex,e.width)}),[]),b=Object(r.useCallback)((function(e){d.current.set(""+e.rowIndex,e.height)}),[]),m=Object(r.useCallback)((function(e){console.log(e)}),[]);return Object(r.useLayoutEffect)((function(){"web"===i.a.OS&&(document.body.style.overflow="hidden")}),[]),Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)(h,{}),Object(f.jsx)(E,{columnCount:Number.MAX_SAFE_INTEGER,rowCount:Number.MAX_SAFE_INTEGER,freezedColumns:{start:1},freezedRows:{start:1},style:[{borderColor:"#fff",width:t,height:n-56},i.a.select({web:{userSelect:"none"}})],getColumnWidth:function(e){if(l.current.has(""+e.columnIndex))return l.current.get(""+e.columnIndex);Math.round(100*Math.random());return[50,140,200,120][e.columnIndex%4]},getRowHeight:function(e){if(d.current.has(""+e.rowIndex))return d.current.get(""+e.rowIndex);Math.round(100*Math.random());return[40,50,60,90,40,45,40,50,55,50][e.rowIndex%10]},onChangeColumn:s,onChangeColumnOrder:m,onChangeRow:b,onChangeVisibleArea:function(e){console.log("onChangeVisibleArea",e)},renderCell:function(e){var t=e.column,n=e.row;return Object(f.jsxs)(u.a,{style:{flex:1,backgroundColor:n.rowIndex%2===1?"rgb(246, 248, 250)":"#fff",borderTopWidth:1,borderLeftWidth:1,borderColor:"rgb(216, 222, 228)",padding:4,borderRightWidth:0===t.columnIndex?1:0,borderBottomWidth:0===n.rowIndex?1:0},children:[0===t.columnIndex&&0===n.rowIndex&&null,0===n.rowIndex&&t.columnIndex>0&&Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)(W,{row:n,column:t,children:Object(f.jsxs)(f.Fragment,{children:[Object(f.jsxs)(a.a,{children:["c: ",t.columnIndex]}),Object(f.jsxs)(a.a,{children:["r: ",n.rowIndex]})]})}),Object(f.jsx)(J,{row:n,column:t})]}),0===t.columnIndex&&n.rowIndex>0&&Object(f.jsxs)(f.Fragment,{children:[Object(f.jsxs)(f.Fragment,{children:[Object(f.jsxs)(a.a,{children:["c: ",t.columnIndex]}),Object(f.jsxs)(a.a,{children:["r: ",n.rowIndex]})]}),Object(f.jsx)(q,{row:n,column:t})]}),t.columnIndex>0&&n.rowIndex>0&&Object(f.jsxs)(f.Fragment,{children:[Object(f.jsxs)(a.a,{children:["c: ",t.columnIndex]}),Object(f.jsxs)(a.a,{children:["r: ",n.rowIndex]})]}),Object(f.jsx)(o.a.View,{style:[{position:"absolute",left:0,top:-1,bottom:-1,width:2,backgroundColor:"blue",opacity:t.highlightOpacityAnimated},i.a.select({web:{pointerEvents:"none"}})]})]})}})]})}},111:function(e,t,n){e.exports=n(137)}},[[111,1,2]]]);
//# sourceMappingURL=app.37d33e8d.chunk.js.map