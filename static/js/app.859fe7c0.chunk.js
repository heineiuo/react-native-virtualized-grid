(this.webpackJsonp=this.webpackJsonp||[]).push([[0],{128:function(e,t,n){e.exports=n(161)},161:function(e,t,n){"use strict";n.r(t);n(93);var r=n(126),o=n(0),i=n(99),u=n(16),c=n(19),l=n(26),a=n(125),d=n(9),s=n(166),f=n(85),h=n(86),b=n(6);function m(){return Object(b.jsxs)(d.default,{style:{height:56,flexDirection:"row",justifyContent:"space-between",alignItems:"center"},children:[Object(b.jsx)(d.default,{style:{paddingLeft:20},children:Object(b.jsx)(l.default,{style:{fontWeight:"bold",fontSize:20},children:"React Native Virtualized Grid"})}),Object(b.jsxs)(d.default,{style:{paddingRight:20,flexDirection:"row",alignItems:"center"},children:[Object(b.jsx)(f.default,{style:{marginRight:12},onPress:function(){h.default.openURL("https://twitter.com/770hz")},children:Object(b.jsx)(s.default,{name:"twitter",size:24,color:"#1d9bf0"})}),Object(b.jsx)(f.default,{onPress:function(){h.default.openURL("https://github.com/heineiuo/react-native-virtualized-grid")},children:Object(b.jsx)(s.default,{name:"github",size:24,color:"black"})})]})]})}var w=n(11),O=n.n(w),j=n(73),x=n.n(j),g=n(40),p=n(48);function y(e){var t=e.renderCell,n=e.column,r=e.row;return Object(b.jsx)(c.default.View,{style:{position:"absolute",width:n.widthAnimated,zIndex:c.default.add(n.zIndexAnimated,r.zIndexAnimated),height:r.heightAnimated,transform:[{translateX:n.xAnimated},{translateY:r.yAnimated}]},children:t({column:n,row:r})})}var v=Object(o.createContext)({}),I=function(){return Object(o.useContext)(v)},R=n(3),C=n.n(R),A=n(4),P=n.n(A),z=function(){function e(){C()(this,e),this._x=0,this._y=0,this.xAnimated=new c.default.Value(0),this.yAnimated=new c.default.Value(0),this.rowIndex=0,this.columnIndex=0,this.left=0,this.top=0}return P()(e,[{key:"x",get:function(){return this._x},set:function(e){this._x=e,this.xAnimated.setValue(e)}},{key:"y",get:function(){return this._y},set:function(e){this._y=e,this.yAnimated.setValue(e)}}]),e}(),V=function(){function e(){C()(this,e),this._offsetX=0,this._offsetY=0,this.offsetXAnimated=new c.default.Value(0),this.offsetYAnimated=new c.default.Value(0),this._width=0,this._height=0,this.widthAnimated=new c.default.Value(0),this.heightAnimated=new c.default.Value(0)}return P()(e,[{key:"offsetX",get:function(){return this._offsetX},set:function(e){this._offsetX=0,this.offsetXAnimated.setValue(e)}},{key:"offsetY",get:function(){return this._offsetY},set:function(e){this._offsetY=0,this.offsetYAnimated.setValue(e)}},{key:"width",get:function(){return this._width},set:function(e){this._width=0,this.widthAnimated.setValue(e)}},{key:"height",get:function(){return this._height},set:function(e){this._height=0,this.heightAnimated.setValue(e)}}]),e}(),k=function(){function e(t){var n=t.x,r=t.width,o=t.columnIndex,i=t.freezed,u=void 0!==i&&i;C()(this,e),this.xAnimated=new c.default.Value(n),this.widthAnimated=new c.default.Value(r),this.columnIndex=o,this.freezed=u,this.zIndexAnimated=new c.default.Value(u?1:0),this.highlightOpacityAnimated=new c.default.Value(0)}return P()(e,[{key:"x",get:function(){return JSON.parse(JSON.stringify(this.xAnimated))}},{key:"width",get:function(){return JSON.parse(JSON.stringify(this.widthAnimated))}}]),e}(),S=function(){function e(t){var n=t.y,r=t.height,o=t.rowIndex,i=t.freezed,u=void 0!==i&&i;C()(this,e),this.yAnimated=new c.default.Value(n),this.heightAnimated=new c.default.Value(r),this.rowIndex=o,this.freezed=u,this.zIndexAnimated=new c.default.Value(u?1:0),this.highlightOpacityAnimated=new c.default.Value(0)}return P()(e,[{key:"y",get:function(){return JSON.parse(JSON.stringify(this.yAnimated))}},{key:"height",get:function(){return JSON.parse(JSON.stringify(this.heightAnimated))}}]),e}();!function(){function e(t){var n=t.column,r=t.row;C()(this,e),this.column=n,this.row=r,this.ref=Object(o.createRef)()}P()(e,[{key:"x",get:function(){return this.column.x}},{key:"y",get:function(){return this.row.y}},{key:"width",get:function(){return this.column.width}},{key:"height",get:function(){return this.row.height}}])}();function E(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function D(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?E(Object(n),!0).forEach((function(t){O()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):E(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function M(e){var t,n,r=e.debug,i=void 0!==r&&r,c=e.style,l=(e.columnCount,e.rowCount,e.renderCell),a=e.onChangeColumn,s=void 0===a?function(e){}:a,f=e.onChangeRow,h=void 0===f?function(e){}:f,m=e.getColumnWidth,w=void 0===m?function(){return 100}:m,O=e.getRowHeight,j=void 0===O?function(){return 40}:O,I=e.freezedColumns,R=void 0===I?{}:I,C=e.freezedRows,A=void 0===C?{}:C,P=e.onChangeColumnOrder,E=void 0===P?function(){}:P,M=e.onChangeRowOrder,_=void 0===M?function(){}:M,X=e.onChangeVisibleArea,Y=void 0===X?function(){}:X,N=e.useScrollView,T=void 0!==N&&N,J=Object(o.useRef)(null),L=(Object(o.useRef)(null),null!=(t=R.start)?t:0),G=null!=(n=A.start)?n:0,W=Object(o.useRef)([]),H=Object(o.useRef)([]),q=Object(o.useState)({notFreezed:{},columnFreezed:{},rowFreezed:{},allFreezed:{}}),B=x()(q,2),U=B[0],K=B[1],Q=Object(o.useRef)(new z),Z=Object(o.useRef)({width:0,height:0}),$=(Object(o.useRef)(new V),Object(o.useCallback)((function(){i&&console.time("update");var e=Z.current,t=e.width,n=e.height,r=Q.current,o=r.rowIndex,u=r.columnIndex,c=r.left,a=r.top,d=r.x,s=r.y,f=c,h=a,m=u,O=o,x=[],g=[],p=null,v=null,I=null,R=null;if(L>0&&m>L-1)for(var C=0,A=0;C<L;){var P=w({columnIndex:C});g.push(new k({columnIndex:C,width:P,x:A,freezed:!0})),C++,A+=P}for(;;){var z=w({columnIndex:m});if(g.push(new k({columnIndex:m,width:z,x:f,freezed:m<L})),p||(p=g.slice(-1)[0]),m++,(f+=z)>-d+t){v=g.slice(-1)[0];break}}if(G>0&&O>G-1)for(var V=0,E=0;V<G;){var D=j({rowIndex:V});x.push(new S({rowIndex:V,height:D,y:E,freezed:!0})),V++,E+=D}for(;;){var M=j({rowIndex:O});if(x.push(new S({rowIndex:O,height:M,y:h,freezed:O<G})),I||(I=x.slice(-1)[0]),O++,(h+=M)>-s+n){R=x.slice(-1)[0];break}}W.current=g,H.current=x;var F=[],_=[],X=[],N=[];for(var T of x)for(var J of g){var q=Object(b.jsx)(y,{column:J,row:T,renderCell:l},J.columnIndex+"/"+T.rowIndex);J.freezed&&T.freezed?F.push(q):J.freezed?X.push(q):T.freezed?N.push(q):_.push(q)}i&&(console.timeEnd("update"),console.log("count",g.length,x.length,g.length*x.length),console.time("setCells")),Y({minRow:I,minColumn:p,maxRow:R,maxColumn:v}),K({notFreezed:{children:_,x:!0,y:!0},columnFreezed:{children:X,y:!0},rowFreezed:{children:N,x:!0},allFreezed:{children:F}}),i&&console.timeEnd("setCells")}),[i,Y,w,j,l,L,G])),ee=Object(o.useCallback)((function(e){var t=e.nativeEvent.layout,n=t.width,r=t.height;Z.current.width=n,Z.current.height=r,$()}),[$]),te=Object(o.useCallback)((function(e){i&&console.time("updateCoordinate");var t=e.deltaX,n=e.deltaY,r=Q.current,o=r.columnIndex,u=r.rowIndex,c=r.left,l=r.top,a=Q.current.x-t;if(a>0)a=0,Q.current.x=0,Q.current.columnIndex=0,Q.current.left=0;else{Q.current.x=a;var d=o,s=c,f=c;if(t>0){for(;;){if(s=f,(f+=w({columnIndex:d}))>=-a)break;d++}Q.current.columnIndex=d,Q.current.left=s}else{for(;!(s<=-a);){d--,s-=w({columnIndex:d})}Q.current.columnIndex=d,Q.current.left=s}}var h=Q.current.y-n;if(h>0)h=0,Q.current.y=0,Q.current.top=0,Q.current.rowIndex=0;else{Q.current.y=h;var b=u,m=l,O=l;if(n>0){for(;;){if(m=O,(O+=j({rowIndex:b}))>=-h)break;b++}Q.current.rowIndex=b,Q.current.top=m}else{for(;!(m<=-h);){b--,m-=j({rowIndex:b})}Q.current.rowIndex=b,Q.current.top=m}}i&&(console.log(Q.current),console.timeEnd("updateCoordinate")),$()}),[$,i,w,j]),ne=Object(o.useMemo)((function(){var e=null,t=0,n=0;return function(r){clearTimeout(e);var o=r.deltaX,i=r.deltaY;t+=o,n+=i,e=setTimeout((function(){te({deltaX:t,deltaY:n}),t=0,n=0}),0)}}),[te]),re=Object(o.useCallback)((function(e){var t=e.nativeEvent.contentOffset,n=t.x,r=t.y;Q.current.y=-r,Q.current.x=-n,setTimeout($,0)}),[$]);Object(o.useEffect)((function(){if(!T&&"web"===u.default.OS){var e=J.current;if(e)return e.addEventListener("wheel",ne),function(){e.removeEventListener("wheel",ne)}}}),[T,ne]);var oe=Object(o.useMemo)((function(){var e=null,t=null,n=0,r=0,o=0,i=0,u=Date.now(),c=0,l=0,a=0,d=0;function s(){a=0,d=0,o=0,i=0,c=0,l=0,u=Date.now(),clearInterval(t),t=setInterval(f,20)}function f(){var e=Date.now(),t=e-u+1;u=e,c=.8*(200*o/t)+.2*c,l=.8*(200*i/t)+.2*l,o=0,i=0}function h(){var e=Date.now()-u,t=Math.exp(-e/325),n=a*t,r=d*t;n>.5||n<-.5||r>.5||r<-.5?(te({deltaX:n,deltaY:r}),requestAnimationFrame(h)):te({deltaX:n,deltaY:r})}return g.default.create({onMoveShouldSetPanResponder:function(){return!0},onPanResponderGrant:function(t,n){e=D({},n),s()},onPanResponderMove:function(t,u){if(!e)return e=D({},u),void s();n=-u.dx+e.dx,r=-u.dy+e.dy,o=n,i=r,e=D({},u),te({deltaX:n,deltaY:r})},onPanResponderRelease:function(){e=null,clearInterval(t),(c>10||c<-10)&&(a=.8*c),(l>10||l<-10)&&(d=.8*l),u=Date.now(),requestAnimationFrame(h)}})}),[te]);return Object(b.jsx)(v.Provider,{value:{virtualColumns:W,virtualRows:H,onChangeColumn:s,onChangeRow:h,coordinate:Q,containerSize:Z,updateCoordinate:te,onChangeColumnOrder:E,onChangeRowOrder:_},children:Object(b.jsxs)(d.default,D(D({ref:J,style:[{overflow:"hidden"},c],onLayout:ee},T?{}:oe.panHandlers),{},{children:[!T&&Object(b.jsx)(F,{translateX:Q.current.xAnimated,translateY:Q.current.yAnimated,children:U.notFreezed.children}),T&&Object(b.jsx)(p.default,{style:{position:"absolute",top:40,left:50,right:0,bottom:0,overflow:"scroll"},scrollEventThrottle:1,onScroll:re,children:Object(b.jsx)(d.default,{style:{width:1e4,height:1e4},children:Object(b.jsx)(d.default,{style:[{position:"absolute",top:-40,left:-50}],children:U.notFreezed.children})})}),Object(b.jsx)(F,{translateY:Q.current.yAnimated,children:U.columnFreezed.children}),Object(b.jsx)(F,{translateX:Q.current.xAnimated,children:U.rowFreezed.children}),Object(b.jsx)(F,{children:U.allFreezed.children})]}))})}function F(e){var t=e.translateX,n=void 0===t?0:t,r=e.translateY,o=void 0===r?0:r,i=e.children;return Object(b.jsx)(c.default.View,{style:[{position:"absolute",transform:[{translateX:n},{translateY:o}]}],children:i})}var _=n(76);function X(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Y(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?X(Object(n),!0).forEach((function(t){O()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):X(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function N(e){var t=e.column,n=e.row,r=I(),i=r.virtualColumns,u=r.onChangeColumn,l=Object(o.useMemo)((function(){var e=[];return g.default.create({onPanResponderTerminate:function(e,t){},onPanResponderTerminationRequest:function(e,t){return!1},onPanResponderReject:function(){},onMoveShouldSetPanResponder:function(e,t){return!0},onPanResponderGrant:function(){for(var n of(t.widthAnimated.setOffset(t.width),e=[],i.current))n.columnIndex>t.columnIndex&&(e.push(n),n.xAnimated.setOffset(n.x))},onPanResponderMove:function(n,r){for(var o of e)o.xAnimated.setValue(r.dx);t.widthAnimated.setValue(r.dx),u(t)},onPanResponderRelease:function(){for(var n of(t.widthAnimated.flattenOffset(),e))n.xAnimated.flattenOffset();e=[]}})}),[t,i,u]);return Object(b.jsx)(c.default.View,Y(Y({},l.panHandlers),{},{style:[{position:"absolute",top:0,right:0,zIndex:10,height:n.height,width:20}],children:Object(b.jsx)(_.default,{style:[{display:"flex",alignItems:"flex-end",height:n.height}],children:function(e){var t=e.hovered;return Object(b.jsx)(c.default.View,{style:[{height:n.heightAnimated,width:0},t&&{width:5,backgroundColor:"blue"}]})}})}))}function T(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function J(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?T(Object(n),!0).forEach((function(t){O()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):T(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function L(e){var t=e.column,n=e.row,r=e.children,i=I(),u=i.virtualColumns,l=i.onChangeColumnOrder,a=Object(o.useMemo)((function(){var e=0,n=null,r=0;return g.default.create({onPanResponderTerminate:function(e,t){},onPanResponderTerminationRequest:function(e,t){return!1},onPanResponderReject:function(){},onMoveShouldSetPanResponder:function(e,t){return!0},onPanResponderGrant:function(n){e=t.x+n.nativeEvent.locationX,r=t.columnIndex},onPanResponderMove:function(t,r){for(var o of u.current){var i=o.x+o.width/2;if(Math.abs(i-e-r.dx)<o.width/2){if(console.log("highlightcolumn",o.columnIndex),n===o)break;n&&n.highlightOpacityAnimated.setValue(0),(n=o).highlightOpacityAnimated.setValue(1);break}}},onPanResponderRelease:function(){n&&(n.highlightOpacityAnimated.setValue(0),r!==n.columnIndex&&l({fromIndex:r,toIndex:n.columnIndex}))}})}),[t,l,u]);return Object(b.jsx)(c.default.View,J(J({},a.panHandlers),{},{style:[{position:"absolute",zIndex:8,top:0,left:0,height:n.height,width:t.width}],children:r}))}function G(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function W(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?G(Object(n),!0).forEach((function(t){O()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):G(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function H(e){var t=e.column,n=e.row,r=I(),i=r.virtualRows,u=r.onChangeRow,l=Object(o.useMemo)((function(){var e=[];return g.default.create({onPanResponderTerminate:function(e,t){},onPanResponderTerminationRequest:function(e,t){return!1},onPanResponderReject:function(){},onMoveShouldSetPanResponder:function(e,t){return!0},onPanResponderGrant:function(){for(var t of(n.heightAnimated.setOffset(n.height),e=[],i.current))t.rowIndex>n.rowIndex&&(e.push(t),t.yAnimated.setOffset(t.y))},onPanResponderMove:function(t,r){for(var o of e)o.yAnimated.setValue(r.dy);n.heightAnimated.setValue(r.dy),u(n)},onPanResponderRelease:function(){for(var t of(n.heightAnimated.flattenOffset(),e))t.yAnimated.flattenOffset();e=[]}})}),[n,i,u]);return Object(b.jsx)(c.default.View,W(W({},l.panHandlers),{},{style:[{position:"absolute",bottom:0,left:0,zIndex:10,height:20,width:t.width}],children:Object(b.jsx)(_.default,{style:[{display:"flex",justifyContent:"flex-end",width:t.width,height:20}],children:function(e){var n=e.hovered;return Object(b.jsx)(c.default.View,{style:[{width:t.widthAnimated,height:0},n&&{height:5,backgroundColor:"blue"}]})}})}))}function q(){var e=Object(a.default)(),t=e.width,n=e.height,r=Object(o.useRef)(new Map),i=Object(o.useRef)(new Map),s=Object(o.useCallback)((function(e){r.current.set(""+e.columnIndex,e.width)}),[]),f=Object(o.useCallback)((function(e){i.current.set(""+e.rowIndex,e.height)}),[]),h=Object(o.useCallback)((function(e){console.log(e)}),[]);return Object(o.useLayoutEffect)((function(){"web"===u.default.OS&&(document.body.style.overflow="hidden")}),[]),Object(b.jsxs)(d.default,{children:[Object(b.jsx)(m,{}),Object(b.jsx)(M,{debug:!1,columnCount:Number.MAX_SAFE_INTEGER,rowCount:Number.MAX_SAFE_INTEGER,freezedColumns:{start:1},freezedRows:{start:1},style:[{borderColor:"#fff",width:t,height:n-56},u.default.select({web:{userSelect:"none"}})],getColumnWidth:function(e){if(r.current.has(""+e.columnIndex))return r.current.get(""+e.columnIndex);Math.round(100*Math.random());return[50,140,200,120][e.columnIndex%4]},getRowHeight:function(e){if(i.current.has(""+e.rowIndex))return i.current.get(""+e.rowIndex);Math.round(100*Math.random());return[40,50,60,90,40,45,40,50,55,50][e.rowIndex%10]},onChangeColumn:s,onChangeColumnOrder:h,onChangeRow:f,onChangeVisibleArea:function(e){},renderCell:function(e){var t=e.column,n=e.row;return Object(b.jsxs)(d.default,{style:{flex:1,backgroundColor:n.rowIndex%2===1?"rgb(246, 248, 250)":"#fff",borderTopWidth:1,borderLeftWidth:1,borderColor:"rgb(216, 222, 228)",padding:4,borderRightWidth:0===t.columnIndex?1:0,borderBottomWidth:0===n.rowIndex?1:0},children:[0===t.columnIndex&&0===n.rowIndex&&null,0===n.rowIndex&&t.columnIndex>0&&Object(b.jsxs)(b.Fragment,{children:[Object(b.jsx)(L,{row:n,column:t,children:Object(b.jsxs)(b.Fragment,{children:[Object(b.jsxs)(l.default,{children:["c: ",t.columnIndex]}),Object(b.jsxs)(l.default,{children:["r: ",n.rowIndex]})]})}),Object(b.jsx)(N,{row:n,column:t})]}),0===t.columnIndex&&n.rowIndex>0&&Object(b.jsxs)(b.Fragment,{children:[Object(b.jsxs)(b.Fragment,{children:[Object(b.jsxs)(l.default,{children:["c: ",t.columnIndex]}),Object(b.jsxs)(l.default,{children:["r: ",n.rowIndex]})]}),Object(b.jsx)(H,{row:n,column:t})]}),t.columnIndex>0&&n.rowIndex>0&&Object(b.jsxs)(b.Fragment,{children:[Object(b.jsxs)(l.default,{children:["c: ",t.columnIndex]}),Object(b.jsxs)(l.default,{children:["r: ",n.rowIndex]})]}),Object(b.jsx)(c.default.View,{style:[{position:"absolute",left:0,top:-1,bottom:-1,width:2,backgroundColor:"blue",opacity:t.highlightOpacityAnimated},u.default.select({web:{pointerEvents:"none"}})]})]})}})]})}"web"===u.default.OS?Object(i.createRoot)(document.getElementById("root")).render(Object(o.createElement)(q)):Object(r.default)(q)}},[[128,1,2]]]);
//# sourceMappingURL=app.859fe7c0.chunk.js.map